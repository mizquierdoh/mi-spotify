(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7922],{6553:(F,P,k)=>{"use strict";k.d(P,{d:()=>b});var N=k(8735);class b{static parse(n){if(!n)return null;let m=new b;return m.id=n.id,m.name=n.name,m.releaseDate=new Date(n.releaseDate),m.artistId=n.artistId,m.artistName=n.artistName,m.externalUrl=n.externalUrl,m.href=n.href,m.uri=n.uri,m.excluded=n.excluded,m.images=n.images.map(H=>N.Q.parse(H)).sort((H,U)=>U.width-H.width),m}static parseWebPlaybackAlbum(n){let m=new b;return n&&(m.externalUrl=n.external_urls.spotify,m.href=n.href,m.id=n.id,m.images=n.images.map(H=>N.Q.parse(H)).sort((H,U)=>U.width-H.width),m.name=n.name,m.releaseDate=new Date(n.release_date),m.uri=n.uri),m}}},7986:(F,P,k)=>{"use strict";k.d(P,{l:()=>b});var N=k(8735);class b{static parse(n){if(!n)return null;let m=new b;return m.externalUrl=n.externalUrl,m.genres=n.genres,m.href=n.href,m.id=n.id,m.images=n.images.map(H=>N.Q.parse(H)).sort((H,U)=>U.width-H.width),m.name=n.name,m.uri=n.uri,m}static parseWebPlaybackArtist(n){if(!n)return null;let m=new b;return m.externalUrl=n.external_urls.spotify,m.genres=n.genres,m.href=n.href,m.id=n.id,n.images&&(m.images=n.images.map(H=>N.Q.parse(H)).sort((H,U)=>U.width-H.width)),m.name=n.name,m.uri=n.uri,m}}},8735:(F,P,k)=>{"use strict";k.d(P,{Q:()=>N});class N{static parse(p){if(!p)return null;let n=new N;return n.height=p.height,n.width=p.width,n.url=p.url,n}}},4733:(F,P,k)=>{"use strict";k.d(P,{t:()=>N});class N{static parse(p){if(!p)return null;let n=new N;return n.id=p.id,n.name=p.name,n.trackNumber=p.trackNumber,n.discNumber=p.discNumber,n.albumId=p.albumId,n.albumName=p.albumName,n.albumReleaseDate=p.albumReleaseDate,n.artistId=p.artistId,n.artistName=p.artistName,n.image=p.image,n.externalURL=p.externalURL,n.href=p.href,n.uri=p.uri,n}static parsePlayerTrack(p){let n=new N;return p&&(n.artistName=p.artists[0],n.id=p.id,n.image=p.image,n.name=p.name,n.uri=p.uri),n}static parseWebPlaybackTrack(p){let n=new N;return p&&(n.albumId=p.album.id,n.albumName=p.album.name,n.albumReleaseDate=new Date(p.album.release_date),n.artistId=p.artists[0].id,n.artistName=p.artists[0].name,n.discNumber=p.disc_number,n.externalURL=p.external_urls.spotify,n.href=p.href,n.id=p.id,n.image=p.album.images.sort((m,H)=>H.width-m.width)[0].url,n.name=p.name,n.uri=p.uri,n.trackNumber=p.track_number),n}}},7922:(F,P,k)=>{"use strict";k.d(P,{$:()=>Y});var x,N=k(5861),b=k(6553),p=k(7986),n=k(8735),m=k(4733),H=k(6738),U=k(3191),L=k(8799),C=k.n(L),A=k(8319),w=k.n(A);!function G(){var E;x=x||function(B,E){var i={},e=i.lib={},f=function(){},g=e.Base={extend:function(r){f.prototype=this;var c=new f;return r&&c.mixIn(r),c.hasOwnProperty("init")||(c.init=function(){c.$super.init.apply(this,arguments)}),c.init.prototype=c,c.$super=this,c},create:function(){var r=this.extend();return r.init.apply(r,arguments),r},init:function(){},mixIn:function(r){for(var c in r)r.hasOwnProperty(c)&&(this[c]=r[c]);r.hasOwnProperty("toString")&&(this.toString=r.toString)},clone:function(){return this.init.prototype.extend(this)}},t=e.WordArray=g.extend({init:function(r,c){r=this.words=r||[],this.sigBytes=null!=c?c:4*r.length},toString:function(r){return(r||u).stringify(this)},concat:function(r){var c=this.words,v=r.words,y=this.sigBytes;if(r=r.sigBytes,this.clamp(),y%4)for(var R=0;R<r;R++)c[y+R>>>2]|=(v[R>>>2]>>>24-R%4*8&255)<<24-(y+R)%4*8;else if(65535<v.length)for(R=0;R<r;R+=4)c[y+R>>>2]=v[R>>>2];else c.push.apply(c,v);return this.sigBytes+=r,this},clamp:function(){var r=this.words,c=this.sigBytes;r[c>>>2]&=4294967295<<32-c%4*8,r.length=B.ceil(c/4)},clone:function(){var r=g.clone.call(this);return r.words=this.words.slice(0),r},random:function(r){for(var c=[],v=0;v<r;v+=4)c.push(4294967296*B.random()|0);return new t.init(c,r)}}),s=i.enc={},u=s.Hex={stringify:function(r){var c=r.words;r=r.sigBytes;for(var v=[],y=0;y<r;y++){var R=c[y>>>2]>>>24-y%4*8&255;v.push((R>>>4).toString(16)),v.push((15&R).toString(16))}return v.join("")},parse:function(r){for(var c=r.length,v=[],y=0;y<c;y+=2)v[y>>>3]|=parseInt(r.substr(y,2),16)<<24-y%8*4;return new t.init(v,c/2)}},l=s.Latin1={stringify:function(r){var c=r.words;r=r.sigBytes;for(var v=[],y=0;y<r;y++)v.push(String.fromCharCode(c[y>>>2]>>>24-y%4*8&255));return v.join("")},parse:function(r){for(var c=r.length,v=[],y=0;y<c;y++)v[y>>>2]|=(255&r.charCodeAt(y))<<24-y%4*8;return new t.init(v,c)}},a=s.Utf8={stringify:function(r){try{return decodeURIComponent(escape(l.stringify(r)))}catch{throw Error("Malformed UTF-8 data")}},parse:function(r){return l.parse(unescape(encodeURIComponent(r)))}},h=e.BufferedBlockAlgorithm=g.extend({reset:function(){this._data=new t.init,this._nDataBytes=0},_append:function(r){"string"==typeof r&&(r=a.parse(r)),this._data.concat(r),this._nDataBytes+=r.sigBytes},_process:function(r){var c=this._data,v=c.words,y=c.sigBytes,R=this.blockSize,V=y/(4*R);if(V=r?B.ceil(V):B.max((0|V)-this._minBufferSize,0),y=B.min(4*(r=V*R),y),r){for(var O=0;O<r;O+=R)this._doProcessBlock(v,O);O=v.splice(0,r),c.sigBytes-=y}return new t.init(O,y)},clone:function(){var r=g.clone.call(this);return r._data=this._data.clone(),r},_minBufferSize:0});e.Hasher=h.extend({cfg:g.extend(),init:function(r){this.cfg=this.cfg.extend(r),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(r){return this._append(r),this._process(),this},finalize:function(r){return r&&this._append(r),this._doFinalize()},blockSize:16,_createHelper:function(r){return function(c,v){return new r.init(v).finalize(c)}},_createHmacHelper:function(r){return function(c,v){return new _.HMAC.init(r,v).finalize(c)}}});var _=i.algo={};return i}(Math),E=x.enc.Utf8,x.algo.HMAC=x.lib.Base.extend({init:function(i,e){i=this._hasher=new i.init,"string"==typeof e&&(e=E.parse(e));var f=i.blockSize,g=4*f;e.sigBytes>g&&(e=i.finalize(e)),e.clamp();for(var t=this._oKey=e.clone(),s=this._iKey=e.clone(),u=t.words,l=s.words,a=0;a<f;a++)u[a]^=1549556828,l[a]^=909522486;t.sigBytes=s.sigBytes=g,this.reset()},reset:function(){var i=this._hasher;i.reset(),i.update(this._iKey)},update:function(i){return this._hasher.update(i),this},finalize:function(i){var e=this._hasher;return i=e.finalize(i),e.reset(),e.finalize(this._oKey.clone().concat(i))}}),function(){var E=x.lib.WordArray;x.enc.Base64={stringify:function(i){var e=i.words,f=i.sigBytes,g=this._map;i.clamp(),i=[];for(var t=0;t<f;t+=3)for(var s=(e[t>>>2]>>>24-t%4*8&255)<<16|(e[t+1>>>2]>>>24-(t+1)%4*8&255)<<8|e[t+2>>>2]>>>24-(t+2)%4*8&255,u=0;4>u&&t+.75*u<f;u++)i.push(g.charAt(s>>>6*(3-u)&63));if(e=g.charAt(64))for(;i.length%4;)i.push(e);return i.join("")},parse:function(i){var e=i.length,f=this._map;(g=f.charAt(64))&&-1!=(g=i.indexOf(g))&&(e=g);for(var g=[],t=0,s=0;s<e;s++)if(s%4){var u=f.indexOf(i.charAt(s-1))<<s%4*2,l=f.indexOf(i.charAt(s))>>>6-s%4*2;g[t>>>2]|=(u|l)<<24-t%4*8,t++}return E.create(g,t)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(){var B=x,E=(f=B.lib).WordArray,i=f.Hasher,e=[],f=B.algo.SHA1=i.extend({_doReset:function(){this._hash=new E.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(g,t){for(var s=this._hash.words,u=s[0],l=s[1],a=s[2],h=s[3],_=s[4],r=0;80>r;r++){if(16>r)e[r]=0|g[t+r];else{var c=e[r-3]^e[r-8]^e[r-14]^e[r-16];e[r]=c<<1|c>>>31}c=(u<<5|u>>>27)+_+e[r],c=20>r?c+(1518500249+(l&a|~l&h)):40>r?c+(1859775393+(l^a^h)):60>r?c+((l&a|l&h|a&h)-1894007588):c+((l^a^h)-899497514),_=h,h=a,a=l<<30|l>>>2,l=u,u=c}s[0]=s[0]+u|0,s[1]=s[1]+l|0,s[2]=s[2]+a|0,s[3]=s[3]+h|0,s[4]=s[4]+_|0},_doFinalize:function(){var g=this._data,t=g.words,s=8*this._nDataBytes,u=8*g.sigBytes;return t[u>>>5]|=128<<24-u%32,t[14+(u+64>>>9<<4)]=Math.floor(s/4294967296),t[15+(u+64>>>9<<4)]=s,g.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var g=i.clone.call(this);return g._hash=this._hash.clone(),g}});B.SHA1=i._createHelper(f),B.HmacSHA1=i._createHmacHelper(f)}()}();class S{constructor(E,i,e,f,g){var t=this;this.consumer_key=E,this.consumer_secret=i,this.token=e,this.token_secret=f,this._version=g,this._base_url="http://api.music-story.com",this.resp=null,this._checker=function(s,u){var l=setInterval(function(){s()&&(clearInterval(l),u())},10)},this._rawurlencode_rfc3986=function(s){return encodeURIComponent(s).replace("+"," ").replace("%7E","~")},this._load=function(s,u,l){var a=document.createElement("script"),h=document.getElementsByTagName("head")[0];a.type="text/javascript";var _="";for(const r in u.data)_?_+="&":_="?",_+=r+"="+encodeURIComponent(u.data[r]);a.src=s+=_,a.onload=function(){t.resp=json,h.removeChild(a),typeof l<"u"&&l()},h.appendChild(a)},this.get=function(s,u,l,a){if(typeof l>"u"&&(l=null),u){s=s.toLowerCase();var h="getObject";t._request(s,u,null,null,h,null,null,function(){t.constructResult(s,h,a)})}},this.search=function(s,u,l,a,h){s=s.toLowerCase();var _="searchObject";!u||t._request(s,null,null,u,_,a,h,function(){t.constructResult(s,_,l)})},this._sign=function(s,u){var r,c,v,l="",a="",h="";if(s){for(r in u||(u={}),c=new Array,u)c.push(r);for(c.sort(),v=0;v<c.length;v++)l&&(l+="&"),l+=(r=t._rawurlencode_rfc3986(c[v]))+"="+t._rawurlencode_rfc3986(u[c[v]]);return a="GET&"+t._rawurlencode_rfc3986(s.toLowerCase())+"&"+t._rawurlencode_rfc3986(l),h=t._rawurlencode_rfc3986(t.consumer_secret)+"&"+t._rawurlencode_rfc3986(t.token_secret),x.HmacSHA1(a,h).toString(x.enc.Base64)}},this._request=function(s,u,l,a,h,_,r,c){!s&&"getConnector"!==h||"searchObject"===h&&!a||!h||(t.token&&t.token_secret?t._requestsuite(s,u,l,a,h,_,r,c):t.getToken(function(){t._requestsuite(s,u,l,a,h,_,r,c)}))},this._requestsuite=function(s,u,l,a,h,_,r,c){var v,y,R,V;for(R in v=t._base_url+"/"+s,u&&(v+="/"+u),"searchObject"===h&&(v+="/search"),"getConnector"===h&&(v=v+"/"+l),v+=".json",y={oauth_token:t.token,_callback:"var json="},_&&(a.page||(a.page=_)),r&&(a.pageCount||(a.pageCount=r)),a)y[R]=a[R];for(R in V=t._sign(v,y),v+="?oauth_signature="+encodeURIComponent(V),y)v+="&"+encodeURIComponent(R)+"="+encodeURIComponent(y[R]);t._load(v,{},c)},this.getToken=function(s){var u,l;t.token="",t.token_secret="",!E||(u=t._base_url+"/",t._version&&(u+=t._version+"/"),l=t._sign(u+="oauth/request_token.json",{oauth_consumer_key:t.consumer_key,_callback:"var json="}),this._load(u,{data:{oauth_consumer_key:t.consumer_key,oauth_signature:l,_callback:"var json="},async:!1},function(){t.token=t.resp.data.token,t.token_secret=t.resp.data.token_secret,s()}))},this.setToken=function(s,u){s&&(t.token=s),u&&(t._token_secret=u)},this.constructResult=function(s,u,l,a){t._checker(function(){return typeof t.resp<"u"&&null!==t.resp},function(){var h=[],_={ConsumerKey:t.consumer_key,ConsumerSecret:t.consumer_secret,AccessToken:t.token,TokenSecret:t.token_secret};if("getConnector"===u||"searchObject"===u)if(t.resp.data){var r=t.resp.count,c=t.resp.currentPage,v=t.resp.pageCount;t.resp.data.forEach(function(V){h.push(new D(t,V,s,_))});var R=new M(h,v,r,c);typeof l<"u"&&l(R,a)}else typeof l<"u"&&l([],a);else R=new D(t,t.resp,s,_),typeof l<"u"&&l(R,a)})}}}function D(B,E,i,e){for(var f in E)this[f]=E[f];var g=this;this.object_name=i,this.token=e.AccessToken,this.token_secret=e.TokenSecret,this.consumer_key=e.ConsumerKey,this.consumer_secret=e.ConsumerSecret,this.getConnector=function(t,s,u,l,a){var h="getConnector";t=t.toLowerCase(),s||(s={}),B._request(this.object_name,g.id,t,s,h,u,l,function(){t="biographies"===t?"biography":t.substr(0,t.length-1),B.constructResult(t,h,a,g)})}}function M(B,E,i,e){this._position=0,this._pageCount=E,this._count=i,this._currentPage=e,this.data=B,this.size=function(){return this._count},this.hasNextPage=function(){return this._currentPage<this._pageCount},this.hasPrevPage=function(){return this._currentPage>1},this.rewind=function(){this._position=0},this.current=function(){return this.data[this._position]?this.data[this._position]:null},this.key=function(){return this._position},this.next=function(){return++this._position,this.current()},this.prev=function(){return--this._position,this.current()},this.valid=function(){return!!this.data},this.hasNext=function(){return!!this.data[this._position+1]},this.hasPrev=function(){return!!this.data[this._position-1]}}var z=k(529);const d="95393125dd0a690b2f3d768b276dece0e556c419",T="45b956d08a34833bd75ec770dd3f2332f986ac98";let $=(()=>{class B{constructor(i){this.http=i,this.token="",this.token_secret="",this.api=new S(d,T,this.token,this.token_secret,""),console.log("Test api",this.api),this.api.getToken(e=>{this.api.search("artist",{name:"Bones of Minerva"},f=>{console.log("searchResult",f),f.data[0].getConnector("albums",{link:"Main",format:"Album",type:"Original"},null,100,function(t,s){console.log("Albums story",t),t.data.forEach(u=>{this.api.get("Album",u.id,null,l=>{console.log(l.data),l.getConnector("spotify",{},null,100,a=>{console.log(u.title,a)})})})})})})}getToken(){let i,e;this.token="",this.token_secret="",i="http://api.music-story.com//",i+="1.0/",e=this.sign(i,{oauth_consumer_key:d}),i+="oauth/request_token.json?oauth_consumer_key=95393125dd0a690b2f3d768b276dece0e556c419&oauth_signature_method=HMAC-SHA1&oauth_timestamp=1661768436&oauth_nonce=yRPX3viRkpl&oauth_version=1.0&oauth_signature=".concat(e),console.log("Music sotory token url:",i),this.http.get(i).subscribe(f=>{console.log("Music story:",f)})}sign(i,e){let u,l,a,h,_,f="",g="",t="",s="";if(i){for(u in e||(e={}),l=new Array,e)l.push(u);for(l.sort(),a=0;a<l.length;a++)u=this.rawurlencode_rfc3986(l[a]),h=this.rawurlencode_rfc3986(e[l[a]]),f&&(f+="&"),f+=u+"="+h;return g="GET&"+this.rawurlencode_rfc3986(i.toLowerCase())+"&"+this.rawurlencode_rfc3986(f),t=this.rawurlencode_rfc3986(T)+"&"+this.rawurlencode_rfc3986(this.token_secret),_=C()(g,t),s=w().stringify(_),s}}rawurlencode_rfc3986(i){return encodeURIComponent(i).replace("+"," ").replace("%7E","~")}}return B.\u0275fac=function(i){return new(i||B)(H.LFG(z.eN))},B.\u0275prov=H.Yz7({token:B,factory:B.\u0275fac,providedIn:"root"}),B})();var Q=k(1188);let Y=(()=>{class B{constructor(i,e,f){this.spotifyService=i,this.musicStoryService=e,this.storageService=f,this.artists=[],this.albums=[],this.tracks=[],this.loaded=!1}getTrack(i){return this.tracks.find(e=>e.id===i)}loadLibrary(i){var e=this;return(0,N.Z)(function*(){if(!i&&e.loaded)return;let f=!!i;const g=yield e.spotifyService.getUserProfile(),t=g.id;console.log(g);const s=yield e.storageService.get(t+"_artists"),u=yield e.storageService.get(t+"_albums"),l=yield e.storageService.get(t+"_tracks");!f&&s&&s.length>0?(e.artists=s.map(a=>p.l.parse(a)),console.log(e.artists)):f=!0,!f&&u&&u.length>0?(e.albums=u.map(a=>b.d.parse(a)),console.log(e.albums)):f=!0,!f&&l&&l.length>0?(e.tracks=l.map(a=>m.t.parse(a)),console.log(e.tracks)):f=!0,f&&(yield e.buildLibrary(t)),e.loaded=!0})()}buildLibrary(i){var e=this;return(0,N.Z)(function*(){e.artists=[],e.albums=[],e.tracks=[];let f=!0,g=null;for(;f;){const t=yield e.spotifyService.getFollowedArtists(g);f=!!t.artists.cursors.after&&t.artists.cursors.after.length>0,f&&(g=t.artists.cursors.after),t.artists.items.forEach((s,u,l)=>{let a=new p.l;a.externalUrl=s.external_urls.spotify,a.genres=s.genres,a.href=s.href,a.id=s.id,a.uri=s.uri,a.images=s.images.map(h=>{let _=new n.Q;return _.height=h.height,_.width=h.width,_.url=h.url,_}).sort((h,_)=>_.width-h.width),a.name=s.name,e.artists.push(a)})}e.artists=e.artists.sort((t,s)=>t.name>s.name?1:-1),e.storageService.set(i+"_artists",e.artists),console.log(e.artists);for(const t of e.artists){f=!0;let s=0;for(;f;){const u=yield e.spotifyService.getArtistsAlbums(t.id,s);f=!!u.next,f&&(s+=5);let l=u.items.map((a,h,_)=>{let r=new b.d;return r.id=a.id,r.name=a.name,r.releaseDate=new Date(a.release_date),r.artistId=t.id,r.artistName=t.name,r.externalUrl=a.external_urls.spotify,r.href=a.href,r.uri=a.uri,r.images=a.images.map(c=>{let v=new n.Q;return v.height=c.height,v.width=c.width,v.url=c.url,v}).sort((c,v)=>v.width-c.width),r}).sort((a,h)=>a.releaseDate.getTime()-h.releaseDate.getTime());e.albums=e.albums.concat(l)}}console.log(e.albums),e.albums=e.albums.sort((t,s)=>t.artistName!==s.artistName?t.artistName<s.artistName?-1:1:t.releaseDate.getTime()-s.releaseDate.getTime()),e.storageService.set(i+"_albums",e.albums);for(const t of e.albums){console.log(t),f=!0;let s=0;for(;f;){const u=yield e.spotifyService.getAlbumsTracks(t.id,s);f=!!u.next,f&&(s+=50);let l=u.items.map(a=>{let h=new m.t;return h.id=a.id,h.name=a.name,h.trackNumber=a.track_number,h.discNumber=a.disc_number,h.albumId=t.id,h.albumName=t.name,h.artistId=t.artistId,h.artistName=t.artistName,h.albumReleaseDate=t.releaseDate,h.image=t.images[0].url,h.externalURL=a.external_urls.spotify,h.href=a.href,h.uri=a.uri,h}).sort((a,h)=>{let _=a.discNumber-h.discNumber;return 0!=_?_:a.trackNumber-h.trackNumber});e.tracks=e.tracks.concat(l)}}e.tracks=e.tracks.sort((t,s)=>t.artistName!==s.artistName?t.artistName<s.artistName?-1:1:t.albumReleaseDate.getTime()!==s.albumReleaseDate.getTime()?t.albumReleaseDate.getTime()-s.albumReleaseDate.getTime():s.trackNumber-t.trackNumber),e.storageService.set(i+"_tracks",e.tracks)})()}getAlbum(i){return this.albums.find(e=>e.id===i)}getArtist(i){return this.artists.find(e=>e.id===i)}getAlbumsByArtist(i){return this.albums.filter(e=>e.artistId===i).sort((e,f)=>e.releaseDate.getTime()-f.releaseDate.getTime())}getTracksByAlbum(i){return this.tracks.filter(e=>e.albumId===i).sort((e,f)=>e.discNumber!=f.discNumber?e.discNumber-f.discNumber:e.trackNumber-f.trackNumber)}nextTrack(i){const e=this.tracks[i],f=this.getTracksByAlbum(e.albumId),g=f.indexOf(e);if(g!=f.length-1)return f[g+1];const t=this.getAlbum(e.albumId),s=this.albums.indexOf(t);return this.getTracksByAlbum(this.nextAlbum(s).id)[0]}nextAlbum(i){const e=this.albums[i],f=this.getAlbumsByArtist(e.artistId),g=f.indexOf(e);if(g!=f.length-1)return f[g+1];const t=this.getArtist(e.artistId),s=this.artists.indexOf(t);return this.getAlbumsByArtist(this.nextArtist(s).id)[0]}nextArtist(i){return this.artists[i==this.artists.length-1?0:i+1]}updateExcluded(i){let e=this.albums.indexOf(i);this.albums[e].excluded=i.excluded,console.log("Update Excluded:",this.albums[e]),this.spotifyService.getUserProfile().then(f=>{this.storageService.set(f.id+"_albums",this.albums)})}}return B.\u0275fac=function(i){return new(i||B)(H.LFG(U.s),H.LFG($),H.LFG(Q.V))},B.\u0275prov=H.Yz7({token:B,factory:B.\u0275fac,providedIn:"root"}),B})()},7585:function(F,P,k){var N;F.exports=(N=N||function(b,p){var n;if(typeof window<"u"&&window.crypto&&(n=window.crypto),typeof self<"u"&&self.crypto&&(n=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(n=globalThis.crypto),!n&&typeof window<"u"&&window.msCrypto&&(n=window.msCrypto),!n&&typeof global<"u"&&global.crypto&&(n=global.crypto),!n)try{n=k(2480)}catch{}var m=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch{}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},H=Object.create||function(){function o(){}return function(d){var T;return o.prototype=d,T=new o,o.prototype=null,T}}(),U={},L=U.lib={},C=L.Base={extend:function(o){var d=H(this);return o&&d.mixIn(o),(!d.hasOwnProperty("init")||this.init===d.init)&&(d.init=function(){d.$super.init.apply(this,arguments)}),d.init.prototype=d,d.$super=this,d},create:function(){var o=this.extend();return o.init.apply(o,arguments),o},init:function(){},mixIn:function(o){for(var d in o)o.hasOwnProperty(d)&&(this[d]=o[d]);o.hasOwnProperty("toString")&&(this.toString=o.toString)},clone:function(){return this.init.prototype.extend(this)}},A=L.WordArray=C.extend({init:function(o,d){o=this.words=o||[],this.sigBytes=null!=d?d:4*o.length},toString:function(o){return(o||x).stringify(this)},concat:function(o){var d=this.words,T=o.words,I=this.sigBytes,K=o.sigBytes;if(this.clamp(),I%4)for(var W=0;W<K;W++)d[I+W>>>2]|=(T[W>>>2]>>>24-W%4*8&255)<<24-(I+W)%4*8;else for(var Q=0;Q<K;Q+=4)d[I+Q>>>2]=T[Q>>>2];return this.sigBytes+=K,this},clamp:function(){var o=this.words,d=this.sigBytes;o[d>>>2]&=4294967295<<32-d%4*8,o.length=b.ceil(d/4)},clone:function(){var o=C.clone.call(this);return o.words=this.words.slice(0),o},random:function(o){for(var d=[],T=0;T<o;T+=4)d.push(m());return new A.init(d,o)}}),w=U.enc={},x=w.Hex={stringify:function(o){for(var d=o.words,T=o.sigBytes,I=[],K=0;K<T;K++){var W=d[K>>>2]>>>24-K%4*8&255;I.push((W>>>4).toString(16)),I.push((15&W).toString(16))}return I.join("")},parse:function(o){for(var d=o.length,T=[],I=0;I<d;I+=2)T[I>>>3]|=parseInt(o.substr(I,2),16)<<24-I%8*4;return new A.init(T,d/2)}},S=w.Latin1={stringify:function(o){for(var d=o.words,T=o.sigBytes,I=[],K=0;K<T;K++)I.push(String.fromCharCode(d[K>>>2]>>>24-K%4*8&255));return I.join("")},parse:function(o){for(var d=o.length,T=[],I=0;I<d;I++)T[I>>>2]|=(255&o.charCodeAt(I))<<24-I%4*8;return new A.init(T,d)}},D=w.Utf8={stringify:function(o){try{return decodeURIComponent(escape(S.stringify(o)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(o){return S.parse(unescape(encodeURIComponent(o)))}},M=L.BufferedBlockAlgorithm=C.extend({reset:function(){this._data=new A.init,this._nDataBytes=0},_append:function(o){"string"==typeof o&&(o=D.parse(o)),this._data.concat(o),this._nDataBytes+=o.sigBytes},_process:function(o){var d,T=this._data,I=T.words,K=T.sigBytes,W=this.blockSize,Q=K/(4*W),Y=(Q=o?b.ceil(Q):b.max((0|Q)-this._minBufferSize,0))*W,B=b.min(4*Y,K);if(Y){for(var E=0;E<Y;E+=W)this._doProcessBlock(I,E);d=I.splice(0,Y),T.sigBytes-=B}return new A.init(d,B)},clone:function(){var o=C.clone.call(this);return o._data=this._data.clone(),o},_minBufferSize:0}),z=(L.Hasher=M.extend({cfg:C.extend(),init:function(o){this.cfg=this.cfg.extend(o),this.reset()},reset:function(){M.reset.call(this),this._doReset()},update:function(o){return this._append(o),this._process(),this},finalize:function(o){return o&&this._append(o),this._doFinalize()},blockSize:16,_createHelper:function(o){return function(d,T){return new o.init(T).finalize(d)}},_createHmacHelper:function(o){return function(d,T){return new z.HMAC.init(o,T).finalize(d)}}}),U.algo={});return U}(Math),N)},8319:function(F,P,k){var N,n;F.exports=(N=k(7585),n=N.lib.WordArray,N.enc.Base64={stringify:function(L){var C=L.words,A=L.sigBytes,w=this._map;L.clamp();for(var x=[],S=0;S<A;S+=3)for(var z=(C[S>>>2]>>>24-S%4*8&255)<<16|(C[S+1>>>2]>>>24-(S+1)%4*8&255)<<8|C[S+2>>>2]>>>24-(S+2)%4*8&255,o=0;o<4&&S+.75*o<A;o++)x.push(w.charAt(z>>>6*(3-o)&63));var d=w.charAt(64);if(d)for(;x.length%4;)x.push(d);return x.join("")},parse:function(L){var C=L.length,A=this._map,w=this._reverseMap;if(!w){w=this._reverseMap=[];for(var x=0;x<A.length;x++)w[A.charCodeAt(x)]=x}var S=A.charAt(64);if(S){var D=L.indexOf(S);-1!==D&&(C=D)}return function U(L,C,A){for(var w=[],x=0,S=0;S<C;S++)if(S%4){var D=A[L.charCodeAt(S-1)]<<S%4*2,M=A[L.charCodeAt(S)]>>>6-S%4*2;w[x>>>2]|=(D|M)<<24-x%4*8,x++}return n.create(w,x)}(L,C,w)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},N.enc.Base64)},8799:function(F,P,k){var N;F.exports=(N=k(7585),k(5162),k(3764),N.HmacSHA1)},3764:function(F,P,k){var N,H;F.exports=(N=k(7585),H=N.enc.Utf8,void(N.algo.HMAC=N.lib.Base.extend({init:function(C,A){C=this._hasher=new C.init,"string"==typeof A&&(A=H.parse(A));var w=C.blockSize,x=4*w;A.sigBytes>x&&(A=C.finalize(A)),A.clamp();for(var S=this._oKey=A.clone(),D=this._iKey=A.clone(),M=S.words,G=D.words,z=0;z<w;z++)M[z]^=1549556828,G[z]^=909522486;S.sigBytes=D.sigBytes=x,this.reset()},reset:function(){var C=this._hasher;C.reset(),C.update(this._iKey)},update:function(C){return this._hasher.update(C),this},finalize:function(C){var A=this._hasher,w=A.finalize(C);return A.reset(),A.finalize(this._oKey.clone().concat(w))}})))},5162:function(F,P,k){var b,p,n,m,U,L,N;F.exports=(N=k(7585),n=(p=(b=N).lib).WordArray,U=[],L=b.algo.SHA1=(m=p.Hasher).extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(C,A){for(var w=this._hash.words,x=w[0],S=w[1],D=w[2],M=w[3],G=w[4],z=0;z<80;z++){if(z<16)U[z]=0|C[A+z];else{var o=U[z-3]^U[z-8]^U[z-14]^U[z-16];U[z]=o<<1|o>>>31}var d=(x<<5|x>>>27)+G+U[z];d+=z<20?1518500249+(S&D|~S&M):z<40?1859775393+(S^D^M):z<60?(S&D|S&M|D&M)-1894007588:(S^D^M)-899497514,G=M,M=D,D=S<<30|S>>>2,S=x,x=d}w[0]=w[0]+x|0,w[1]=w[1]+S|0,w[2]=w[2]+D|0,w[3]=w[3]+M|0,w[4]=w[4]+G|0},_doFinalize:function(){var C=this._data,A=C.words,w=8*this._nDataBytes,x=8*C.sigBytes;return A[x>>>5]|=128<<24-x%32,A[14+(x+64>>>9<<4)]=Math.floor(w/4294967296),A[15+(x+64>>>9<<4)]=w,C.sigBytes=4*A.length,this._process(),this._hash},clone:function(){var C=m.clone.call(this);return C._hash=this._hash.clone(),C}}),b.SHA1=m._createHelper(L),b.HmacSHA1=m._createHmacHelper(L),N.SHA1)},2480:()=>{}}]);